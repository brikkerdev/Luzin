# Задача 2: Спящий парикмахер (Sleeping Barber)

## Постановка задачи

Моделируется работа парикмахерской с одним парикмахером и ограниченной очередью клиентов.

Правила:
1) Если клиентов нет, парикмахер спит.
2) Клиент, войдя и не найдя парикмахера занятым, будит его и садится в кресло.
3) Клиенты, пришедшие во время стрижки, садятся в очередь (если есть свободные места).
4) Если очередь полна, клиент уходит.
5) Парикмахер работает, пока парикмахерская открыта или пока есть клиенты в очереди.

## Структура

```
Task2/
  Task2.cs   - Реализация логики парикмахера, очереди и генерации клиентов
  README.md  - Описание задачи
```

## Основные компоненты

1) Парикмахер (метод `BarberWork`, отдельный поток):
   - Проверяет наличие клиентов.
   - Если клиентов нет, засыпает (ожидает на семафоре `_barberSemaphore`).
   - Берёт клиента из очереди и стрижёт.

2) Генератор клиентов (метод `GenerateCustomers`, отдельный поток):
   - Создаёт новых клиентов через случайные интервалы.
   - Пытается добавить клиента в очередь (если есть место).
   - Если появился первый клиент, будит парикмахера (через `_barberSemaphore`).

3) Очередь клиентов (`Queue<int> _waitingCustomers`):
   - Ограниченный размер (`_maxQueueSize`).
   - Доступ защищён объектом `_queueLock` (через `lock`).

## Синхронизация

- `Semaphore _customerSemaphore`  
  Считает количество клиентов в очереди.  
  Парикмахер ждёт этот семафор перед тем, как брать клиента.

- `Semaphore _barberSemaphore`  
  Используется для пробуждения парикмахера при появлении клиентов.

- `object _queueLock`  
  Защищает операции с очередью (`Enqueue` / `Dequeue`) от одновременного доступа.

## Как запустить задачу 2

Из `Program.cs`:
```
var task2 = new Lab4.Task2.Task2(maxQueueSize: 5);
task2.Run();
```